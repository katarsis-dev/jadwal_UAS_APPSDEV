<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
  <link rel="stylesheet" href="assets/css/bootstrap-icons.css" />
  <link rel="stylesheet" href="assets/css/style.css" />
  <title>Home - Jadwal Unikama</title>
  <script src="https://cdn.jsdelivr.net/npm/eruda"></script>
<script>eruda.init();</script>
</head>

<body>
  <div class="container py-3">
    <h4 class="mb-3">Jadwal Kuliah</h4>
    <div id="semesterSection" class="mb-3 d-none">
      <div class="row g-2">
        <div class="col-6">
          <label class="form-label small text-muted">Semester:</label>
          <select class="form-select" id="filterSemester">
            <option value="all">Semua</option>
          </select>
        </div>
        <div class="col-6">
          <label class="form-label small text-muted">Hari:</label>
          <select class="form-select" id="filterHari">
            <option value="all">Semua Hari</option>
            <option value="SENIN">Senin</option>
            <option value="SELASA">Selasa</option>
            <option value="RABU">Rabu</option>
            <option value="KAMIS">Kamis</option>
            <option value="JUMAT">Jumat</option>
            <option value="SABTU">Sabtu</option>
          </select>
        </div>
      </div>
    </div>



    <div class="d-grid gap-2 mt-4">
  <div class="card mb-3 border-0 shadow-sm">
    <div class="card-body p-3">
        <h6 class="fw-bold mb-2"><i class="bi bi-music-note-beamed me-2"></i>Kostum Musik Alarm</h6>
        <div class="d-flex align-items-center gap-2">
            <input type="file" id="inputMusic" accept="audio/*" class="form-control form-control-sm">
            <button class="btn btn-sm btn-outline-primary" onclick="previewMusic()">
                <i class="bi bi-play-fill"></i>
            </button>
        </div>
        <small class="text-muted" style="font-size: 0.7rem;">Pilih satu lagu untuk semua alarm matkul.</small>
      </div>
    </div>
<div class="d-flex gap-2 mb-3">
  <button class="btn btn-primary btn-lg flex-fill d-flex align-items-center justify-content-center" data-bs-toggle="modal" data-bs-target="#modalManual">
    <i class="bi bi-pencil-square me-2"></i> 
    <span style="font-size: 0.9rem;">Input Manual</span>
  </button>

  <button class="btn btn-outline-primary btn-lg flex-fill d-flex align-items-center justify-content-center" data-bs-toggle="modal" data-bs-target="#modalScan">
    <i class="bi bi-camera me-2"></i> 
    <span style="font-size: 0.9rem;">Scan Jadwal</span>
  </button>
</div>
      
    </div>
    <div id="emptyView" class="text-center py-5">
      <i class="bi bi-calendar4-week display-1 text-muted"></i>
      <p class="text-muted mt-3">Jadwal belum diisi.</p>
    </div>

    <div id="scheduleListView" class="mt-4"></div>

    <nav class="bottom-nav">
      <a href="index.html" class="nav-link active"><i class="bi bi-house-door-fill"></i>Home</a>
      <a href="scan.html" class="nav-link"><i class="bi bi-qr-code-scan"></i>Scan Barcode</a>
    </nav>

    <div class="modal fade" id="modalManual" tabindex="-1" aria-labelledby="modalManualLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content card-custom">
          <div class="modal-header border-0">
            <h5 class="modal-title fw-bold" id="modalManualLabel">Tambah Jadwal Manual</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="formManual">
              <input type="hidden" id="inputId">
              <div class="mb-3">
                <label class="form-label small fw-bold">Nama Mata Kuliah</label>
                <input type="text" class="form-control" id="inputMatkul" placeholder="Contoh: Pemrograman Web" required>
              </div>
              <div class="row">
                <div class="col-6 mb-3">
                  <label class="form-label small fw-bold">Hari</label>
                  <select class="form-select" id="inputHari">
                    <option value="SENIN">Senin</option>
                    <option value="SELASA">Selasa</option>
                    <option value="RABU">Rabu</option>
                    <option value="KAMIS">Kamis</option>
                    <option value="JUMAT">Jumat</option>
                    <option value="SABTU">Sabtu</option>
                  </select>
                </div>
                <div class="col-6 mb-3">
                  <label class="form-label small fw-bold">Semester</label>
                  <input type="number" class="form-control" id="inputSemester" value="5">
                </div>
              </div>
              <div class="row">
                <div class="col-6 mb-3">
                  <label class="form-label small fw-bold">Jam Mulai</label>
                  <input type="time" class="form-control" id="inputJamMulai" required>
                </div>
                <div class="col-6 mb-3">
                  <label class="form-label small fw-bold">Jam Selesai</label>
                  <input type="time" class="form-control" id="inputJamSelesai" required>
                </div>
              </div>
              <div class="mb-3">
                <label class="form-label small fw-bold">Ruangan / Lab</label>
                <input type="text" class="form-control" id="inputRuang" placeholder="Contoh: Lab. Internet">
              </div>
              <div class="mb-3">
                <label class="form-label">Ingatkan Saya (Menit Sebelum)</label>
                <select class="form-select" id="reminderMinutes">
                  <option value="5">5 Menit Sebelum</option>
                  <option value="15" selected>15 Menit Sebelum</option>
                  <option value="30">30 Menit Sebelum</option>
                  <option value="60">1 Jam Sebelum</option>
                </select>
              </div>
            </form>
          </div>

          <div class="modal-footer border-0">
            <button type="button" class="btn btn-light" data-bs-dismiss="modal">Batal</button>
            <button type="submit" form="formManual" class="btn btn-primary px-4">Simpan Jadwal</button>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="modalScan" tabindex="-1" aria-labelledby="modalScanLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content card-custom">
          <div class="modal-header border-0">
            <h5 class="modal-title fw-bold" id="modalScanLabel">Scan Foto Jadwal</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body text-center">
            <div id="scanPreview" class="qr-placeholder mb-3">
              <i class="bi bi-image text-muted display-4"></i>
            </div>
            <p class="small text-muted mb-4">Pilih atau ambil foto jadwal dari galeri/kamera untuk dideteksi otomatis.
            </p>

            <input type="file" id="fileOCR" accept="image/*" class="d-none">

            <button type="button" class="btn btn-outline-primary w-100 mb-2"
              onclick="document.getElementById('fileOCR').click()">
              <i class="bi bi-folder2-open"></i> Pilih Foto Jadwal
            </button>
            <button type="button" id="btnStartOCR" class="btn btn-primary w-100 d-none">
              Mulai Ekstrak Teks
            </button>

            <div id="ocrProgress" class="progress mt-3 d-none" style="height: 10px;">
              <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%">
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="modalAlarm" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="modalAlarmLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content border-danger">
      <div class="modal-header bg-danger text-white">
        <h5 class="modal-title" id="modalAlarmLabel text-center w-100">ðŸš¨ WAKTUNYA KULIAH! ðŸš¨</h5>
      </div>
      <div class="modal-body text-center">
        <h3 id="alarmMatkul" class="fw-bold">---</h3>
        <p id="alarmRuang" class="fs-5">---</p>
        <div class="py-2">
            <p class="text-muted small italic">Cepat siap-siap!</p>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger w-100 fw-bold" id="btnStopAlarm">MATIKAN ALARM</button>
      </div>
    </div>
  </div>
</div>
    <script src="./assets/js/bootstrap.bundle.min.js"></script>

    <script src="./assets/js/tesseract.min.js"></script>

    <script src="./assets/js/index.js"></script>

    <script>
  if ("serviceWorker" in navigator) {
    window.addEventListener("load", () => {
      navigator.serviceWorker
        .register("./sw.js") // Titik satu artinya sejajar dengan index.html
        .then((reg) => console.log("SW Registered! Scope:", reg.scope))
        .catch((err) => console.error("SW Registration Failed", err));
    });
  }
</script>
</body>

</html>